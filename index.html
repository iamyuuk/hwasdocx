<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>21班作业大全</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
                background: #f9f9f9;
            }

            header {
                background: #4a90e2;
                color: white;
                padding: 15px;
                text-align: center;
                font-size: 1.5em;
            }

            main {
                display: flex;
                flex-direction: column;
                padding: 10px;
            }

            #fileList {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 10px;
                padding: 0;
                list-style: none;
                margin: 0;
            }

            #fileList li {
                background: white;
                border-radius: 8px;
                padding: 15px;
                text-align: center;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
                transition:
                    transform 0.2s,
                    box-shadow 0.2s;
                cursor: pointer;
            }

            #fileList li:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            }

            #fileList li.active {
                background-color: #4a90e2;
                color: white;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }

            #fileList li a {
                text-decoration: none;
                color: inherit;
                font-weight: bold;
                display: block;
            }

            /* 控制按钮 */
            #viewerControls {
                margin: 10px 0;
                display: flex;
                gap: 10px;
                position: relative;
                z-index: 1;
            }

            #viewerControls button {
                padding: 8px 12px;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                background: #4a90e2;
                color: white;
                font-weight: bold;
                transition: 0.2s;
            }

            #viewerControls button:hover {
                background: #357abd;
            }

            #viewer {
                width: 100%;
                height: 70vh;
                border: none;
                border-radius: 8px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
                z-index: 0;
            }

            /* 全屏 iframe */
            #viewer.fullscreen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                z-index: 9999;
                border-radius: 0;
                box-shadow: none;
            }

            /* 全屏时按钮浮在 iframe 上方 */
            #viewerControls.fullscreen {
                position: fixed;
                top: 10px;
                left: 10px;
                z-index: 10000;
            }

            @media (max-width: 600px) {
                #fileList {
                    grid-template-columns: repeat(
                        auto-fill,
                        minmax(120px, 1fr)
                    );
                }
                header {
                    font-size: 1.2em;
                }
            }
        </style>
    </head>
    <body>
        <header>21班作业大全 (点击按钮即可打开)</header>
        <main>
            <ul id="fileList"></ul>
            <div id="viewerControls">
                <button id="fullscreenBtn">全屏显示</button>
                <button id="exitFullscreenBtn" style="display: none">
                    退出全屏
                </button>
            </div>
            <iframe id="viewer">请选择一个文档以查看</iframe>
        </main>

        <script>
            const fileListEl = document.getElementById("fileList");
            const viewerEl = document.getElementById("viewer");
            const fullscreenBtn = document.getElementById("fullscreenBtn");
            const exitFullscreenBtn =
                document.getElementById("exitFullscreenBtn");
            const viewerControls = document.getElementById("viewerControls");

            let currentActive = null;

            // 加载文件列表
            fetch("files/list.json")
                .then((res) => res.json())
                .then((files) => {
                    files.forEach((file) => {
                        const li = document.createElement("li");
                        const a = document.createElement("a");
                        const title = file.replace(/\.docx$/i, "");
                        a.textContent = title;

                        // 点击事件：打开 DOCX 并高亮
                        li.onclick = () => {
                            const fileUrl =
                                window.location.origin + "/files/" + file;
                            const encodedUrl = encodeURIComponent(fileUrl);
                            viewerEl.src = `https://view.officeapps.live.com/op/embed.aspx?src=${encodedUrl}`;

                            // 高亮当前按钮
                            if (currentActive)
                                currentActive.classList.remove("active");
                            li.classList.add("active");
                            currentActive = li;
                        };

                        li.appendChild(a);
                        fileListEl.appendChild(li);
                    });
                })
                .catch((err) => {
                    fileListEl.innerHTML = "<li>加载文件列表失败</li>";
                    console.error(err);
                });

            // 全屏显示
            fullscreenBtn.onclick = () => {
                if (!viewerEl.src || viewerEl.src === "") {
                    alert("请先选择一个文档再全屏显示");
                    return;
                }
                viewerEl.classList.add("fullscreen");
                fullscreenBtn.style.display = "none";
                exitFullscreenBtn.style.display = "inline-block";
                viewerControls.classList.add("fullscreen");
            };

            // 退出全屏
            exitFullscreenBtn.onclick = () => {
                viewerEl.classList.remove("fullscreen");
                exitFullscreenBtn.style.display = "none";
                fullscreenBtn.style.display = "inline-block";
                viewerControls.classList.remove("fullscreen");
            };
        </script>
    </body>
</html>
