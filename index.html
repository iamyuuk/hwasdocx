<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>21班作业大全</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
                background: #f9f9f9;
            }
            header {
                background: #4a90e2;
                color: white;
                padding: 15px;
                text-align: center;
                font-size: 1.5em;
            }
            main {
                display: flex;
                flex-direction: column;
                padding: 10px;
            }
            #fileList {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 10px;
                padding: 0;
                list-style: none;
                margin: 0;
            }
            #fileList li {
                background: white;
                border-radius: 8px;
                padding: 15px;
                text-align: center;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
                transition: transform 0.2s;
            }
            #fileList li:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            }
            #fileList li a {
                text-decoration: none;
                color: #333;
                font-weight: bold;
                display: block;
            }
            #viewer {
                width: 100%;
                height: 70vh;
                border: none;
                margin-top: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }
            @media (max-width: 600px) {
                #fileList {
                    grid-template-columns: repeat(
                        auto-fill,
                        minmax(120px, 1fr)
                    );
                }
                header {
                    font-size: 1.2em;
                }
            }
        </style>
    </head>
    <body>
        <header>21班作业大全(点击按钮即可打开)</header>
        <main>
            <ul id="fileList"></ul>
            <iframe id="viewer">请选择一个文档以查看</iframe>
        </main>

        <script>
            const fileListEl = document.getElementById("fileList");
            const viewerEl = document.getElementById("viewer");

            // 加载静态 JSON 文件列表
            fetch("files/list.json")
                .then((res) => res.json())
                .then((files) => {
                    files.forEach((file) => {
                        const li = document.createElement("li");
                        const a = document.createElement("a");
                        // 从文件名生成标题（去掉后缀）
                        const title = file.replace(/\.docx$/i, "");
                        a.textContent = title;
                        a.onclick = () => openDoc(file);
                        li.appendChild(a);
                        fileListEl.appendChild(li);
                    });
                })
                .catch((err) => {
                    fileListEl.innerHTML = "<li>加载文件列表失败</li>";
                    console.error(err);
                });

            // 打开 Office Online Viewer
            function openDoc(filename) {
                const fileUrl = window.location.origin + "/files/" + filename;
                const encodedUrl = encodeURIComponent(fileUrl);
                viewerEl.src = `https://view.officeapps.live.com/op/embed.aspx?src=${encodedUrl}`;
            }
        </script>
    </body>
</html>
